<!DOCTYPE HTML>
<!--
	Striped by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>WebGoat</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="../css/ie/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-desktop.css" />
			<link rel="stylesheet" href="css/style-wide.css" />
		</noscript>
		<!--[if lte IE 8]><link rel="stylesheet" href="../css/ie/v8.css" /><![endif]-->
	</head>
	<!--
		Note: Set the body element's class to "left-sidebar" to position the sidebar on the left.
		Set it to "right-sidebar" to, you guessed it, position it on the right.
	-->
	
	<body class="left-sidebar">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Content -->
					<div id="content">
						<div class="inner">
					
							<!-- Post -->
								<article class="box post post-excerpt">
									<header>
										<!--
											Note: Titles and subtitles will wrap automatically when necessary, so don't worry
											if they get too long. You can also remove the <p> entirely if you don't
											need a subtitle.
										-->
										<h2>CSRF Token By-Pass</h2>
									</header>
									

									<p>
										<div id="lessonContent">    
											Similar to the CSRF Lesson, your goal is to send an email to a newsgroup that contains a malicious 
											request to transfer funds.  To successfully complete you need to obtain a valid request token.  
											The page that presents the transfer funds form contains a valid request token.  The URL for the 
											transfer funds page is the same as this lesson with an extra parameter "transferFunds=main". Load 
											this page, read the token and append the token in a forged request to transferFunds. When you think
											the attack is successful, refresh the page and you will find the green check on the left hand side menu.
											<br>
									        <b>Note that the "Screen" and "menu" GET variables will vary between WebGoat builds. Copying the menu link on the left will give you the current values.</b>
									    </div>
									    <div id="lessonContent">
									        <form accept-charset="UNKNOWN" method="POST" name="form" action="attack?Screen=2&amp;menu=900" enctype="">
									            <table border="0" cellpadding="0" cellspacing="0">
									                <tbody>
									                    <tr>
									                        <td>Title: </td>
									                        <td><input name="title" value="" type="TEXT"></td>
								                        </tr>
								                        <tr>
								                            <td valign="TOP">Message: </td>
								                            <td><textarea rows="12" wrap="soft" name="message" cols="60"></textarea></td>
								                        </tr>
								                    </tbody>
								                </table>
								                <p>
								                	<input name="SUBMIT" value="Submit" type="SUBMIT">
							                    </p>
							                    <hr>
						                        <hr>
					                            <h1>Message List</h1>
					                            <table border="0" cellpadding="0" cellspacing="0">
					                                <tbody>
					                                    <tr>
					                                        <td><a href="attack?Screen=2&amp;menu=900&amp;Num=5" style="cursor:hand"></a></td>
					                                    </tr>
					                                    <tr>
					                                        <td><a href="attack?Screen=2&amp;menu=900&amp;Num=8" style="cursor:hand"></a></td>
					                                    </tr>
					                                </tbody>
					                            </table>
					                        </form>
					                        <script>goat.utils.makeFormsAjax();goat.utils.ajaxifyAttackHref();</script>
					                    </div>
									</p>
								</article>
							</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar"></div>
			</div>

	</body>
</html>